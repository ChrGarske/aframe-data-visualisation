<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>webVR Data Visualization</title>
  <meta name="DataVisTetst">
  <script src="https://aframe.io/releases/0.9.0/aframe.min.js"></script>
  <script> // Script prototype for events when hovering with the cursor over an object
    AFRAME.registerComponent('cursorlistener', {
      init: function () {
        this.el.addEventListener('click', function () {
          this.setAttribute('material', 'color', 'green');
          this.el.emit('clicked')
        });
        this.el.addEventListener('mouseleave', function () {
          this.setAttribute('material', 'color', 'grey');
        });
      }
    });
  </script>
  <script> 
    AFRAME.registerComponent('show_cursorlistener', {
      init: function () {
        this.el.addEventListener('click', function () {
          this.parentNode.querySelector('#x').setAttribute('visible','true');
          this.parentNode.querySelector('#x').setAttribute('class','clickable');
          this.parentNode.querySelector('#y').setAttribute('visible','true');
          this.parentNode.querySelector('#y').setAttribute('class','clickable');
          this.parentNode.querySelector('#z').setAttribute('visible','true');
          this.parentNode.querySelector('#z').setAttribute('class','clickable');
        });
      }
    });
  </script>
  <script> 
    AFRAME.registerComponent('hide_cursorlistener', {
      init: function () {
        this.el.addEventListener('click', function () {
          this.parentNode.querySelector('#x').setAttribute('visible','false');
          this.parentNode.querySelector('#x').removeAttribute('class','clickable');
          this.parentNode.querySelector('#y').setAttribute('visible','false');
          this.parentNode.querySelector('#y').removeAttribute('class','clickable');
          this.parentNode.querySelector('#z').setAttribute('visible','false');
          this.parentNode.querySelector('#z').removeAttribute('class','clickable');
        });
      }
    });
  </script>
  <script> 
    AFRAME.registerComponent('x_cursorlistener', {
      init: function () {
        this.el.addEventListener('click', function () {
          this.setAttribute('material', 'color', 'red');
        });
        this.el.addEventListener('mouseleave', function () {
          this.setAttribute('material', 'color', 'grey');
        });
      }
    });
  </script>
  <script> 
    AFRAME.registerComponent('y_cursorlistener', {
      init: function () {
        this.el.addEventListener('click', function () {
          this.setAttribute('material', 'color', 'white');
        });
        this.el.addEventListener('mouseleave', function () {
          this.setAttribute('material', 'color', 'grey');
        });
      }
    });
  </script>
  <script> 
    AFRAME.registerComponent('z_cursorlistener', {
      init: function () {
        this.el.addEventListener('click', function () {
          this.setAttribute('material', 'color', 'black');
        });
        this.el.addEventListener('mouseleave', function () {
          this.setAttribute('material', 'color', 'grey');
        });
      }
    });
  </script>
  <script> //script for the creation of an octagonal "room"
    AFRAME.registerComponent('room', {
      init: function () {
        var space = document.querySelector('a-scene');
        var i;
        var w = 10,
          h = 15;
        for (i = 0; i < 8; i++) {
          var sheet = document.createElement('a-entity');
          var alpha = i / 4 * Math.PI;
          sheet.setAttribute('class', 'mycanvas');
          sheet.setAttribute('geometry', {
            primitive: 'plane',
            height: h,
            width: w
          });
          sheet.setAttribute('material', {
            metalness: 0,
            color: '#f0f0f0'
          });
          sheet.setAttribute('position', { x: 10 * Math.sin(alpha), y: 1, z: 10 * Math.cos(alpha) });
          sheet.setAttribute('rotation', { x: 0, y: (i - 4) / 8 * 360, z: 0 });
          sheet.setAttribute('buttons', '');
          sheet.setAttribute('value',i);
          space.appendChild(sheet);
        }
      }
    });
  </script>
  <script> //creating the buttons on the walls
    AFRAME.registerComponent('buttons', {
      init: function () {
        var b = ["x", "y", "z", "show", "hide"];
        var bx = [0.2, 0.8, 0.2, 0.2, 0.8].map(function (x) { return 10 * (x - .5) });
        var by = [0.35, 0.7, 0.75, 0.2, 0.2].map(function (x) { return 15 * (x - .5) });
        for (j = 0; j < 5; j++) {
          var button = document.createElement('a-entity');
          button.setAttribute('geometry', {
            primitive: 'box',
            height: '.5',
            width: '1',
            depth: '.1'
          });
          button.setAttribute('material', 'color', 'grey');
          button.setAttribute('position', { x: bx[j], y: by[j], z: 0 });
          button.setAttribute(b[j] + '_cursorlistener', '');
          button.setAttribute('rotation', { x: 0, y: 0, z: 0 });
          button.setAttribute('id', b[j]);
          if (j<3){
            button.setAttribute('visible','false');
          } else{
            button.setAttribute('class', 'clickable');
          }
          var buttontext = document.createElement('a-text');
          buttontext.setAttribute('value', b[j]);
          buttontext.setAttribute('color', 'black');
          buttontext.setAttribute('align', 'center');
          buttontext.setAttribute('position', { x: 0, y: 0, z: .055 });
          button.appendChild(buttontext);
          this.el.appendChild(button);
        }
      }
    });
  </script>
  <script src="https://d3js.org/d3.v5.min.js"></script>

</head>

<body>
  <a-scene background="color:#CECECE" room>
    <a-entity camera look-controls wasd-controls>
      <!-- gaze controls -->
      <a-entity
        animation__click="property: scale; startEvents: click; easing: easeInCubic; dur: 150; from: 0.5 0.5 0.5; to: 1 1 1"
        animation__fusing="property: scale; startEvents: fusing; easing: easeInCubic; dur: 1500; from: 1 1 1; to: 0.5 0.5 0.5"
        animation__mouseleave="property: scale; startEvents: mouseleave; easing: easeInCubic; dur: 500; to: 1 1 1"
        cursor="fuse:true; raycaster:{objects: .clickable}" position="0 0 -1"
        geometry="primitive:ring; radiusInner:0.02; radiusOuter:0.03" material="color:black; shader:flat">
      </a-entity>
    </a-entity>
    <a-sky color="cyan"> </a-sky>
    <a-plane color="black" position="0 -5 0" height="20" width="20" repeat="10 10" rotation="-90 0 0"></a-plane>
  </a-scene>
</body>

</html>